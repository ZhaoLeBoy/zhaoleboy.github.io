---
layout:     post
title:      "ARP"
subtitle:   "ARP"
date:        2021-01-18
author:     "ZhaoLe"
# header-img: "img/redis/post-bg.png"
catalog: true
tags:
    - TCP/IP
---

### ARP基本概念
地址解析协议：仅仅用于IPv4中，提供在IPv4地址和各种网络技术使用的硬件地址间的映射。
地址解析是发现两个地址之间的映射关系的过程，从逻辑Internet地址向对应物理硬件地址进行转换。`ARP几乎总是用于32位IPv4地址和以太网的48位MAC地址之间的映射`

### ARP包格式

![1](/img/tcp/arp/1.png)

* 硬件类型：数据链路层使用的 类型，对于以太网来说是1。
* 协议类型：使用的高层协议，对于IPv4是0x0800。
* 硬件大小：硬件地址长度。
* 协议大小：使用协议的逻辑地址长度。
* op：1 ARP请求，2 ARP应答，3 RARP请求，4 RARP应答
* 发送方硬件地址：发送方的MAC地址。
* 发送方协议地址：发送方IP地址。
* 目的硬件地址：目的方的MAC地址。
* 目的协议地址：目的方IP地址。

> 注意：  
> 1.	对于一个ARP请求除了目的硬件地址之外，其他字段 都要填充  
> 2. 当系统收到ARP请求，会填充上硬件地址，并且将发送发地址和接收方地址互换，Op设置为2  

	
### 工作模式
ARP工作在正常模式下，仅适用于`广播网络`，在一个共享的链路层网段上，ARP 向所有主机发送一个ARP Request 的链路层广播。
![2](/img/tcp/arp/2.png)
![3](/img/tcp/arp/3.png)

同一广播域中的所有系统可接受ARP请求。仅需要响应一个ARP应答。这个应答包含了IPv4地址和对应的MAC地址。然后接受ARP请求的主机学习IPv4到MAC地址的映射，并记录在内存中供以后使用

### ARP缓存超时
每次使用条目后重新启动超时。
软状态:在超时到达前没有更新而丢弃的信息。如果网络条件发生改变，软状态有助于启动自动重新配置。因此很多Internet协议使用软状态。软状态的成本是协议必须刷新状态以避免过期。



### 资料引用

* 《TCP/IP 详解卷1》



